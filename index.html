<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PW Gulf | Student Dashboard</title>
<style>
  :root{
    --bg:#f7f9fc; --card:#ffffff; --ink:#111827; --muted:#6b7280;
    --accent:#2563eb; --accent-2:#1e40af;
    --ok:#16a34a; --warn:#f59e0b; --danger:#ef4444;
    --line:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    -webkit-font-smoothing:antialiased;
  }

  /* Header */
  .site-header{
    position:sticky; top:0; z-index:1000;
    display:grid; grid-template-columns:auto 1fr auto;
    align-items:center; gap:12px;
    padding:14px 18px;
    color:#fff; background:linear-gradient(90deg,var(--accent-2),var(--accent),var(--accent-2));
    box-shadow:0 8px 24px rgba(37,99,235,.25);
  }
  .logo{height:42px; width:auto; border-radius:6px; box-shadow:0 0 0 2px rgba(255,255,255,.12)}
  .site-header h1{margin:0; text-align:center; font-size:18px; font-weight:800; letter-spacing:.2px}
  .header-spacer{width:42px}
  @media (max-width:640px){
    .site-header{grid-template-columns:1fr; text-align:center}
    .header-spacer{display:none}
  }

  .wrap{max-width:1300px; margin:0 auto; padding:16px}

  /* Tabs */
  .tabs{display:flex; gap:8px; margin:10px 0 14px; flex-wrap:wrap}
  .tab-btn{
    appearance:none; border:1px solid var(--line); background:#fff; color:var(--ink);
    padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:600;
  }
  .tab-btn.active{ background:var(--accent); color:#fff; border-color:transparent }
  .tab-panel{ display:none }
  .tab-panel.active{ display:block }

  /* Cards / KPI */
  .panel{
    background:var(--card); border:1px solid var(--line); border-radius:14px;
    padding:16px; box-shadow:0 4px 12px rgba(0,0,0,.06);
  }
  .panel h2{margin:0 0 10px; font-size:18px}
  .kpis{display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin:10px 0 14px}
  .kpi{
    background:#fff; border:1px solid var(--line); border-radius:12px; padding:12px;
  }
  .kpi-label{font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.03em}
  .kpi-value{font-size:26px; font-weight:800; margin-top:2px}
  .kpi.ok{border-left:4px solid var(--ok)}
  .kpi.warn{border-left:4px solid var(--warn)}
  .kpi.info{border-left:4px solid var(--accent)}

  /* Actions row */
  .actions{display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:6px 0 10px}
  .btn{
    appearance:none; border:0; background:var(--accent); color:#fff;
    padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700;
  }
  .btn.secondary{ background:#eef2ff; color:#1e3a8a; border:1px solid #c7d2fe }
  .btn.ghost{ background:#fff; color:var(--ink); border:1px solid var(--line) }

  /* Uploader */
  .uploader{
    display:flex; align-items:center; gap:10px; flex-wrap:wrap;
    border:1px dashed var(--line); border-radius:10px; padding:10px 12px; background:#fff;
  }
  .uploader.drag{ background:#eff6ff; border-color:#93c5fd }

  /* Table */
  .table-wrap{
    background:#fff; border:1px solid var(--line); border-radius:12px; overflow:auto;
  }
  table{width:100%; border-collapse:separate; border-spacing:0}
  thead th{
    position:sticky; top:0; z-index:5;
    background:#f8fafc; border-bottom:1px solid var(--line); padding:10px; text-align:left; font-size:13px;
    white-space:nowrap;
  }
  tbody td{
    border-bottom:1px solid var(--line); padding:9px 10px; font-size:14px;
    vertical-align:top;
  }
  tr:hover td{ background:#f9fafb }
  .filter-row input{
    width:100%; padding:6px 8px; border:1px solid var(--line); border-radius:8px; font-size:12px;
    background:#fff;
  }
  .sortable{cursor:pointer; user-select:none}
  .sortable:after{content:" ⬍"; opacity:.35; font-size:11px}

  .pill{display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; font-weight:700}
  .pill.ok{ background:#ecfdf5; color:#065f46; border:1px solid #a7f3d0 }
  .pill.warn{ background:#fffbeb; color:#92400e; border:1px solid #fde68a }
  .pill.bad{ background:#fef2f2; color:#991b1b; border:1px solid #fecaca }

  /* Topper panel */
  .topper{
    display:grid; grid-template-columns:1fr; gap:10px;
    background:#fff; border:1px solid var(--line); border-radius:12px; padding:12px;
  }
  .topper .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
  .select{padding:8px 10px; border:1px solid var(--line); border-radius:8px; background:#fff}

  .muted{color:var(--muted); font-size:12px}
</style>
</head>
<body>

<header class="site-header">
  <!-- Replace src with your base64 if you want logo embedded -->
  <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/9/98/OOjs_UI_icon_userAvatar.svg" alt="Logo">
  <h1>PW Gulf — Academic Dashboard</h1>
  <div class="header-spacer"></div>
</header>

<div class="wrap">

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" data-tab="attendance">Attendance</button>
    <button class="tab-btn" data-tab="objective">Objective Tests</button>
    <button class="tab-btn" data-tab="subjective">Subjective Tests</button>
  </div>

  <!-- Attendance Panel -->
  <section id="attendance" class="tab-panel active">
    <div class="panel">
      <h2>Attendance Overview</h2>
      <div class="kpis">
        <div class="kpi info"><div class="kpi-label">Total Rows</div><div id="attRows" class="kpi-value">0</div></div>
        <div class="kpi ok"><div class="kpi-label">Present</div><div id="attPresent" class="kpi-value">0</div></div>
        <div class="kpi warn"><div class="kpi-label">Absent</div><div id="attAbsent" class="kpi-value">0</div></div>
        <div class="kpi info"><div class="kpi-label">Attendance %</div><div id="attRate" class="kpi-value">0%</div></div>
      </div>

      <div class="actions">
        <div class="uploader" id="attDrop">
          <strong>Upload CSV</strong>
          <input id="attFile" type="file" accept=".csv" />
          <span class="muted">or drag & drop</span>
        </div>
        <button id="attRefresh" class="btn">Refresh from Sheet</button>
        <span class="muted">Filters appear under headers. Click headers to sort.</span>
      </div>

      <div class="table-wrap" id="attTableWrap"></div>
    </div>
  </section>

  <!-- Objective Tests Panel -->
  <section id="objective" class="tab-panel">
    <div class="panel">
      <h2>Objective Tests</h2>
      <div class="kpis">
        <div class="kpi info"><div class="kpi-label">Total Records</div><div id="objRows" class="kpi-value">0</div></div>
        <div class="kpi ok"><div class="kpi-label">Average Score</div><div id="objAvg" class="kpi-value">-</div></div>
        <div class="kpi info"><div class="kpi-label">Max Score</div><div id="objMax" class="kpi-value">-</div></div>
        <div class="kpi warn"><div class="kpi-label">Min Score</div><div id="objMin" class="kpi-value">-</div></div>
      </div>

      <div class="actions">
        <div class="uploader" id="objDrop">
          <strong>Upload CSV</strong>
          <input id="objFile" type="file" accept=".csv" />
          <span class="muted">or drag & drop</span>
        </div>
        <button id="objRefresh" class="btn">Refresh from Sheet</button>
        <select id="objScoreCol" class="select"></select>
        <span class="muted">Pick score column if needed</span>
      </div>

      <div class="topper" id="objTopperBox">
        <div class="row"><strong>Topper(s):</strong> <span id="objTopper" class="muted">—</span></div>
      </div>

      <div class="table-wrap" id="objTableWrap"></div>
    </div>
  </section>

  <!-- Subjective Tests Panel -->
  <section id="subjective" class="tab-panel">
    <div class="panel">
      <h2>Subjective Tests</h2>
      <div class="kpis">
        <div class="kpi info"><div class="kpi-label">Total Records</div><div id="subRows" class="kpi-value">0</div></div>
        <div class="kpi ok"><div class="kpi-label">Average Marks</div><div id="subAvg" class="kpi-value">-</div></div>
        <div class="kpi info"><div class="kpi-label">Max Marks</div><div id="subMax" class="kpi-value">-</div></div>
        <div class="kpi warn"><div class="kpi-label">Min Marks</div><div id="subMin" class="kpi-value">-</div></div>
      </div>

      <div class="actions">
        <div class="uploader" id="subDrop">
          <strong>Upload CSV</strong>
          <input id="subFile" type="file" accept=".csv" />
          <span class="muted">or drag & drop</span>
        </div>
        <button id="subRefresh" class="btn">Refresh from Sheet</button>
        <select id="subScoreCol" class="select"></select>
        <span class="muted">Pick score column if needed</span>
      </div>

      <div class="topper">
        <div class="row"><strong>Topper(s):</strong> <span id="subTopper" class="muted">—</span></div>
      </div>

      <div class="table-wrap" id="subTableWrap"></div>
    </div>
  </section>
</div>

<script>
/* ======= CONFIG: paste your published CSV links here ======= */
const CSV_ATTENDANCE_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRAlfVnrnY4xye72jsXLtGwuBRKl51Xo24re0TScU-AD7aWpgFEgJtOQOrO9lzgFzpTuubnXNBvKwAZ/pub?gid=0&single=true&output=csv";
const CSV_OBJECTIVE_URL  = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRAlfVnrnY4xye72jsXLtGwuBRKl51Xo24re0TScU-AD7aWpgFEgJtOQOrO9lzgFzpTuubnXNBvKwAZ/pub?gid=1944265869&single=true&output=csvE";
const CSV_SUBJECTIVE_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRAlfVnrnY4xye72jsXLtGwuBRKl51Xo24re0TScU-AD7aWpgFEgJtOQOrO9lzgFzpTuubnXNBvKwAZ/pub?gid=1445613757&single=true&output=csv";
/* ========================================================== */

/* ======= Tiny CSV parser (handles quoted commas) ======= */
function parseCSV(text){
  const rows=[]; let cur=[], field='', inQuotes=false;
  for(let i=0;i<text.length;i++){
    const ch=text[i], next=text[i+1];
    if(ch==='\"'){
      if(inQuotes && next==='\"'){ field+='\"'; i++; }
      else inQuotes=!inQuotes;
    }else if(ch===',' && !inQuotes){
      cur.push(field); field='';
    }else if((ch==='\n' || ch==='\r') && !inQuotes){
      if(field!=='' || cur.length){ cur.push(field); rows.push(cur); cur=[]; field=''; }
      if(ch==='\r' && next==='\n'){ i++; } // CRLF
    }else{
      field+=ch;
    }
  }
  if(field!=='' || cur.length) cur.push(field), rows.push(cur);
  return rows.map(r => r.map(c => c.trim()));
}
function escapeHtml(s){ return (s||"").replace(/[&<>"]/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[m])); }

/* ======= Tabs ======= */
document.querySelectorAll('.tab-btn').forEach(b=>{
  b.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-btn').forEach(x=>x.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    document.getElementById(b.dataset.tab).classList.add('active');
  });
});

/* ======= Generic table renderer with filters & sorting ======= */
function renderTable(container, rows){
  if(!rows || !rows.length){ container.innerHTML = `<div class="muted" style="padding:10px">No data</div>`; return { header:[], data:[] }; }
  const header = rows[0], data = rows.slice(1);

  // DOM
  const wrap = document.createElement('div');
  const table = document.createElement('table');

  // Header + filter row
  const thead = document.createElement('thead');
  const trh = document.createElement('tr');
  const trf = document.createElement('tr'); trf.className = 'filter-row';

  header.forEach((h, idx)=>{
    const th = document.createElement('th');
    th.innerHTML = `<span class="sortable" data-col="${idx}">${escapeHtml(h||'')}</span>`;
    trh.appendChild(th);

    const tf = document.createElement('th');
    tf.innerHTML = `<input type="text" data-col="${idx}" placeholder="Filter ${escapeHtml(h||'')}">`;
    trf.appendChild(tf);
  });
  thead.appendChild(trh); thead.appendChild(trf);

  // Body
  const tbody = document.createElement('tbody');

  let sortCol = -1, sortDir = 1;
  let filtered = data.slice();
  const inputs = [];

  function applyFilters(){
    filtered = data.filter(r=>{
      return inputs.every(inp=>{
        const col = +inp.dataset.col;
        const val = (r[col]||'')+'';
        const q = inp.value.trim().toLowerCase();
        return q ? val.toLowerCase().includes(q) : true;
      });
    });
    drawBody();
  }

  function drawBody(){
    tbody.innerHTML = '';
    let arr = filtered.slice();
    if(sortCol>=0){
      arr.sort((a,b)=>{
        const A = a[sortCol]??'', B = b[sortCol]??'';
        const nA = parseFloat(A.replace(/[^0-9.\-]/g,'')), nB = parseFloat(B.replace(/[^0-9.\-]/g,''));
        const numA = !isNaN(nA), numB = !isNaN(nB);
        if(numA && numB) return (nA-nB)*sortDir;
        return A.localeCompare(B)*sortDir;
      });
    }
    for(const r of arr){
      const tr = document.createElement('tr');
      r.forEach(c=>{
        const td = document.createElement('td');
        td.innerHTML = linkify(c);
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    }
  }

  // Sorting
  trh.querySelectorAll('.sortable').forEach(s=>{
    s.addEventListener('click', ()=>{
      const col = +s.dataset.col;
      if(sortCol===col) sortDir = -sortDir;
      else { sortCol = col; sortDir = 1; }
      drawBody();
    });
  });

  // Filters
  trf.querySelectorAll('input').forEach(inp=>{
    inputs.push(inp);
    inp.addEventListener('input', applyFilters);
  });

  table.appendChild(thead); table.appendChild(tbody);
  wrap.appendChild(table);
  container.innerHTML = '';
  container.appendChild(wrap);

  // Initial draw
  drawBody();

  return { header, data: rows.slice(1), getFiltered: ()=>filtered.slice() };
}

/* Turn links / meets / drive into clickable */
function linkify(val){
  const s = (val??'')+'';
  if(!s) return '';
  const isURL = /^https?:\/\/\S+/i.test(s);
  if(isURL){
    // if looks like drive/download/meet render with nicer text
    let label = s;
    if(/meet\.google\.com/i.test(s)) label = 'Join Google Meet';
    else if(/drive\.google\.com/i.test(s)) label = 'Open Drive File';
    else if(/\.(pdf|jpg|jpeg|png|docx?|xlsx?|pptx?)($|\?)/i.test(s)) label = 'Download';
    return `<a href="${s}" target="_blank" rel="noopener">${escapeHtml(label)}</a>`;
  }
  return escapeHtml(s);
}

/* ======= Attendance logic ======= */
let attState = { header:[], data:[] };

async function fetchCSV(url){
  const res = await fetch(url + (url.includes('?') ? '&' : '?') + '_=' + Date.now(), {cache:'no-store'});
  if(!res.ok) throw new Error('Failed to fetch CSV');
  return parseCSV(await res.text());
}
function computeAttendanceKpi(header, rows){
  // Try to find a Status-like column
  const statusIdx = header.findIndex(h=>/status|present|attendance/i.test(h));
  let present=0, absent=0;
  if(statusIdx>-1){
    rows.forEach(r=>{
      const v=(r[statusIdx]||'').toLowerCase();
      if(/present|p\b|yes/.test(v)) present++;
      else if(/absent|a\b|no/.test(v)) absent++;
    });
  }
  const total = rows.length;
  const rate = total ? Math.round((present/total)*100) : 0;
  document.getElementById('attRows').textContent = total;
  document.getElementById('attPresent').textContent = present;
  document.getElementById('attAbsent').textContent = absent;
  document.getElementById('attRate').textContent = rate + '%';
}

async function loadAttendanceFromURL(){
  const rows = await fetchCSV(CSV_ATTENDANCE_URL);
  const {header, data} = renderTable(document.getElementById('attTableWrap'), rows);
  attState = {header, data};
  computeAttendanceKpi(header, data);
}

/* ======= Tests (Objective/Subjective) shared helpers ======= */
function autoPickScoreColumn(header){
  // Prefer column names that look like score/marks/percent
  const prefer = [/percent|percentage/i, /score|marks?/i, /total/i];
  for(const rx of prefer){
    const idx = header.findIndex(h=>rx.test(h));
    if(idx>-1) return idx;
  }
  // else pick last numeric-looking column
  return header.length-1;
}
function fillScoreColumnSelect(sel, header, picked){
  sel.innerHTML = '';
  header.forEach((h,i)=>{
    const opt = document.createElement('option');
    opt.value = i; opt.textContent = `${i+1}. ${h||'(blank)'}`;
    if(i===picked) opt.selected = true;
    sel.appendChild(opt);
  });
}
function computeScoreKPIs(header, rows, scoreIdx, ids={}){
  const nums = rows
    .map(r => parseFloat((r[scoreIdx]||'').toString().replace(/[^0-9.\-]/g,'')))
    .filter(v => !isNaN(v));
  const total = rows.length;
  const avg = nums.length ? (nums.reduce((a,b)=>a+b,0)/nums.length) : NaN;
  const max = nums.length ? Math.max(...nums) : NaN;
  const min = nums.length ? Math.min(...nums) : NaN;
  if(ids.avg) ids.avg.textContent = isNaN(avg) ? '-' : avg.toFixed(2);
  if(ids.max) ids.max.textContent = isNaN(max) ? '-' : max.toFixed(2);
  if(ids.min) ids.min.textContent = isNaN(min) ? '-' : min.toFixed(2);
  if(ids.rows) ids.rows.textContent = total;

  // toppers (could be multiple ties)
  if(ids.topper){
    if(nums.length){
      const topperRows = rows.filter(r=>{
        const v = parseFloat((r[scoreIdx]||'').toString().replace(/[^0-9.\-]/g,''));
        return v===max;
      });
      // Try to infer a name column
      const nameIdx = header.findIndex(h=>/name|student/i.test(h));
      const names = topperRows.map(r => (nameIdx>-1 ? r[nameIdx] : r.join(' | '))).slice(0,5);
      ids.topper.textContent = names.join(', ') + (topperRows.length>5 ? ' …' : '');
    }else{
      ids.topper.textContent = '—';
    }
  }
}

/* ======= Objective ======= */
let objState = { header:[], data:[], scoreIdx:0 };
async function loadObjectiveFromURL(){
  const rows = await fetchCSV(CSV_OBJECTIVE_URL);
  const {header, data} = renderTable(document.getElementById('objTableWrap'), rows);
  objState.header = header; objState.data = data;
  objState.scoreIdx = autoPickScoreColumn(header);
  fillScoreColumnSelect(document.getElementById('objScoreCol'), header, objState.scoreIdx);
  computeScoreKPIs(header, data, objState.scoreIdx, {
    avg:document.getElementById('objAvg'),
    max:document.getElementById('objMax'),
    min:document.getElementById('objMin'),
    rows:document.getElementById('objRows'),
    topper:document.getElementById('objTopper')
  });
}

/* ======= Subjective ======= */
let subState = { header:[], data:[], scoreIdx:0 };
async function loadSubjectiveFromURL(){
  const rows = await fetchCSV(CSV_SUBJECTIVE_URL);
  const {header, data} = renderTable(document.getElementById('subTableWrap'), rows);
  subState.header = header; subState.data = data;
  subState.scoreIdx = autoPickScoreColumn(header);
  fillScoreColumnSelect(document.getElementById('subScoreCol'), header, subState.scoreIdx);
  computeScoreKPIs(header, data, subState.scoreIdx, {
    avg:document.getElementById('subAvg'),
    max:document.getElementById('subMax'),
    min:document.getElementById('subMin'),
    rows:document.getElementById('subRows'),
    topper:document.getElementById('subTopper')
  });
}

/* ======= Upload handlers (drag & drop or file) ======= */
function wireDropZone(zoneEl, inputEl, onRows){
  zoneEl.addEventListener('dragover', (e)=>{ e.preventDefault(); zoneEl.classList.add('drag'); });
  zoneEl.addEventListener('dragleave', ()=> zoneEl.classList.remove('drag'));
  zoneEl.addEventListener('drop', async (e)=>{
    e.preventDefault(); zoneEl.classList.remove('drag');
    if(!e.dataTransfer.files?.length) return;
    const f=e.dataTransfer.files[0];
    const text = await f.text();
    onRows(parseCSV(text));
  });
  inputEl.addEventListener('change', async ()=>{
    if(!inputEl.files?.length) return;
    const text = await inputEl.files[0].text();
    onRows(parseCSV(text));
    inputEl.value = '';
  });
}

/* ======= Wire everything ======= */
document.getElementById('attRefresh').addEventListener('click', ()=> loadAttendanceFromURL().catch(console.error));
document.getElementById('objRefresh').addEventListener('click', ()=> loadObjectiveFromURL().catch(console.error));
document.getElementById('subRefresh').addEventListener('click', ()=> loadSubjectiveFromURL().catch(console.error));

wireDropZone(document.getElementById('attDrop'), document.getElementById('attFile'), (rows)=>{
  const {header, data} = renderTable(document.getElementById('attTableWrap'), rows);
  attState = {header, data};
  computeAttendanceKpi(header, data);
});
wireDropZone(document.getElementById('objDrop'), document.getElementById('objFile'), (rows)=>{
  const {header, data} = renderTable(document.getElementById('objTableWrap'), rows);
  objState.header=header; objState.data=data;
  objState.scoreIdx = autoPickScoreColumn(header);
  fillScoreColumnSelect(document.getElementById('objScoreCol'), header, objState.scoreIdx);
  computeScoreKPIs(header, data, objState.scoreIdx, {
    avg:document.getElementById('objAvg'),
    max:document.getElementById('objMax'),
    min:document.getElementById('objMin'),
    rows:document.getElementById('objRows'),
    topper:document.getElementById('objTopper')
  });
});
wireDropZone(document.getElementById('subDrop'), document.getElementById('subFile'), (rows)=>{
  const {header, data} = renderTable(document.getElementById('subTableWrap'), rows);
  subState.header=header; subState.data=data;
  subState.scoreIdx = autoPickScoreColumn(header);
  fillScoreColumnSelect(document.getElementById('subScoreCol'), header, subState.scoreIdx);
  computeScoreKPIs(header, data, subState.scoreIdx, {
    avg:document.getElementById('subAvg'),
    max:document.getElementById('subMax'),
    min:document.getElementById('subMin'),
    rows:document.getElementById('subRows'),
    topper:document.getElementById('subTopper')
  });
});

/* Score column selectors */
document.getElementById('objScoreCol').addEventListener('change', (e)=>{
  objState.scoreIdx = +e.target.value;
  computeScoreKPIs(objState.header, objState.data, objState.scoreIdx, {
    avg:document.getElementById('objAvg'),
    max:document.getElementById('objMax'),
    min:document.getElementById('objMin'),
    rows:document.getElementById('objRows'),
    topper:document.getElementById('objTopper')
  });
});
document.getElementById('subScoreCol').addEventListener('change', (e)=>{
  subState.scoreIdx = +e.target.value;
  computeScoreKPIs(subState.header, subState.data, subState.scoreIdx, {
    avg:document.getElementById('subAvg'),
    max:document.getElementById('subMax'),
    min:document.getElementById('subMin'),
    rows:document.getElementById('subRows'),
    topper:document.getElementById('subTopper')
  });
});

/* Initial load (from Google Sheet URLs if provided) */
(async function init(){
  try{ if(CSV_ATTENDANCE_URL.startsWith('http')) await loadAttendanceFromURL(); }catch(e){ console.warn('Attendance:', e.message) }
  try{ if(CSV_OBJECTIVE_URL.startsWith('http'))  await loadObjectiveFromURL(); }catch(e){ console.warn('Objective:', e.message) }
  try{ if(CSV_SUBJECTIVE_URL.startsWith('http')) await loadSubjectiveFromURL(); }catch(e){ console.warn('Subjective:', e.message) }
})();
</script>
</body>
</html>
